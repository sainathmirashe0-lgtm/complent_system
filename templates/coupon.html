{% extends "base.html" %}
{% block content %}

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* ========== GLOBAL ========== */
* {
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
}

body {
  background: linear-gradient(120deg, #0a2540, #2b1055);
}

/* ========== POINTS (RIGHT SIDE) ========== */
.points-mini {
  position: fixed;
  top: 90px;
  right: 25px;
  width: 200px;
  background: #0f172a;
  color: #fff;
  padding: 14px;
  border-radius: 12px;
  font-size: 14px;
  text-align: center;
  box-shadow: 0 10px 25px rgba(0,0,0,.35);
  z-index: 999;
}

/* ========== CONTAINER ========== */
.coupon-container {
  max-width: 1100px;
  margin: 40px auto;
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  color: white;
}

h2, h3 {
  text-align: center;
}

/* ========== ALERT ========== */
.coupon-alert {
  max-width: 700px;
  margin: 20px auto;
  background: linear-gradient(90deg,#22c55e,#16a34a);
  color: white;
  padding: 14px 18px;
  border-radius: 14px;
  text-align: center;
  font-size: 14px;
  box-shadow: 0 10px 25px rgba(0,0,0,.3);
}

/* ========== GRID ========== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
  margin-top: 30px;
}

/* ========== CARDS ========== */
.card {
  background: white;
  color: #222;
  border-radius: 16px;
  padding: 22px;
  text-align: center;
  box-shadow: 0 10px 25px rgba(0,0,0,.25);
  transition: 0.3s;
}

.card:hover {
  transform: translateY(-6px);
}

.card h3 {
  color: #2b1055;
}

.card .points {
  font-size: 15px;
  margin: 12px 0;
}

.card button {
  background: linear-gradient(135deg, #ff9800, #ff5722);
  border: none;
  padding: 10px 18px;
  border-radius: 10px;
  color: white;
  cursor: pointer;
  font-size: 14px;
}

.card button:disabled {
  background: #aaa;
  cursor: not-allowed;
}

/* ========== COUPON LIST ========== */
.coupon-box {
  margin-top: 40px;
  background: rgba(255,255,255,0.12);
  padding: 20px;
  border-radius: 14px;
}

.coupon {
  background: white;
  color: #222;
  padding: 12px;
  border-radius: 10px;
  margin: 8px 0;
  text-align: center;
  font-weight: 600;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.copy-btn {
  background: #4f46e5;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 12px;
  cursor: pointer;
}
</style>

<!-- üî• RIGHT SIDE POINTS -->
<div class="points-mini">
  üéÅ Points<br>
  <b>{{ user.reward_points }}</b>
</div>

<div class="coupon-container">

  <h2>üéÅ Redeem Reward Points</h2>
  <p style="text-align:center;opacity:.9">
    Use your points to unlock discounts
  </p>

  <!-- TOP MESSAGE -->
  <div class="coupon-alert">
    üéâ You can use this coupon <b>any shoping app</b> & <b>Goverment pay the money</b><br>
    ‚è≥ Valid for <b>15 days</b> ‚Ä¢ üõë One-time use only
  </div>

  <!-- DISCOUNT SLABS -->
  <div class="grid">
    {% for slab in slabs %}
    <div class="card">
      <h3>{{ slab.discount }}% OFF</h3>
      <div class="points">Requires {{ slab.points }} points</div>

      <form method="POST">
        <input type="hidden" name="points" value="{{ slab.points }}">
        <input type="hidden" name="discount" value="{{ slab.discount }}">

        <button {% if user.reward_points < slab.points %}disabled{% endif %}>
          Redeem
        </button>
      </form>
    </div>
    {% endfor %}
  </div>

  <!-- ACTIVE COUPONS -->
  <div class="coupon-box">
    <h3>Your Active Coupons</h3>

    {% for c in coupons %}
      <div class="coupon">
        <span>{{ c.code }} ‚Äî {{ c.discount_percent }}% OFF</span>
        <button class="copy-btn" onclick="copyCode('{{ c.code }}')">
          Copy
        </button>
      </div>
    {% else %}
      <p style="text-align:center;opacity:.7">
        No active coupons yet
      </p>
    {% endfor %}
  </div>

</div>

<script>
function copyCode(code) {
  navigator.clipboard.writeText(code);
  alert("Coupon code copied: " + code);
}
</script>

{% endblock %}
