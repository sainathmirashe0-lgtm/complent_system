<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sign Up | Complaint System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/css/register.css">
</head>
<body>

  <div class="signup-container">
    <h2>Create Account üöÄ</h2>
    <p class="subtitle">Join the Complaint System</p>

    <!-- ================= REGISTER FORM ================= -->
    {% if step == "form" %}
    <form method="POST" onsubmit="return validatePassword()">
      <div class="field">
        <label>Full Name</label>
        <input type="text" name="name" placeholder="Your name" required>
      </div>

      <div class="field">
        <label>Email</label>
        <input type="email" name="email" placeholder="you@example.com" required>
      </div>

      <div class="field">
        <label>Password</label>
        <input type="password" id="password" name="password"
               placeholder="Min 6 chars, 1 capital, 1 number, 1 symbol"
               required>
      </div>

      <div class="field">
        <label>Confirm Password</label>
        <input type="password" id="confirm" name="confirm"
               placeholder="Repeat password" required>
      </div>

      <!-- PASSWORD RULES -->
      <ul class="rules">
        <li id="len">‚úî Minimum 6 characters</li>
        <li id="cap">‚úî One uppercase letter</li>
        <li id="num">‚úî One number</li>
        <li id="sym">‚úî One special symbol</li>
      </ul>

      <button type="submit">Create Account</button>

      <p class="extra">
        Already have an account?
        <a href="{{ url_for('login') }}">Login</a>
      </p>
    </form>
    {% endif %}

    <!-- ================= OTP FORM ================= -->
    {% if step == "otp" %}
    <form method="POST">
      <h3>Verify OTP üîê</h3>

      <div class="field">
        <input type="text" name="otp" placeholder="Enter 6-digit OTP" required>
      </div>

      <button type="submit">Verify OTP</button>

      <p class="extra">Check your email for OTP</p>
    </form>
    {% endif %}
  </div>

<script>
function validatePassword() {
  const pwd = document.getElementById("password").value;
  const confirm = document.getElementById("confirm").value;

  const lengthOK = pwd.length >= 6;
  const capOK = /[A-Z]/.test(pwd);
  const numOK = /[0-9]/.test(pwd);
  const symOK = /[^A-Za-z0-9]/.test(pwd);

  document.getElementById("len").classList.toggle("ok", lengthOK);
  document.getElementById("cap").classList.toggle("ok", capOK);
  document.getElementById("num").classList.toggle("ok", numOK);
  document.getElementById("sym").classList.toggle("ok", symOK);

  if (!lengthOK || !capOK || !numOK || !symOK) {
    alert("Password does not meet requirements");
    return false;
  }

  if (pwd !== confirm) {
    alert("Passwords do not match");
    return false;
  }

  return true;
}
</script>

</body>
</html>
